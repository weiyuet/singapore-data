---
title: "Singapore Data Project"
subtitle: "Visualising publicly available data published by the government"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document: 
    code_folding: hide
    theme: paper
    highlight: tango
    fig_width: 8
    fig_height: 6
    toc: yes
    toc_depth: 2
    toc_float: yes
    number_sections: true
---

```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#Libraries
library(tidyverse)
library(scales)
library(ggalt)
library(ggsci)
```

Data.gov.sg was launched in 2011 as the government's one-stop portal to its publicly-available data sets from 70 public agencies.
  
  - A personal project
  
  - Find insights from making visualizations
  
  - Singapore is a small country facing unique challenges
  
  - Data from [data.gov.sg](https://data.gov.sg/open-data-licence) and [Department of Statistics Singapore.](https://www.singstat.gov.sg/)
  
  - The Singapore Open Data Licence aims to promote and enable easy reuse of Public Sector data to create value for the community and businesses

![](https://cdn.pixabay.com/photo/2018/09/27/11/43/singapore-3706832_960_720.jpg)

# Society

## Live Births and Fertility

Singapore has one of the lowest fertility rates globally [World Bank](https://data.worldbank.org/indicator/SP.DYN.TFRT.IN?locations=SG).

```{r Live births}
#Load data
live_births <- read_csv("data/births-and-fertility-annual/live-births.csv")

live_births$value <- as.double(as.character(live_births$value))

#Plot live births
live_births %>% 
  drop_na() %>% 
  ggplot(aes(x = year, y = value, colour = level_1)) +
  geom_line(size = 1.05) +
  geom_hline(yintercept = 40000, linetype = 2, size = 0.5) +
  facet_wrap(~level_1, scales = "free") +
  scale_y_continuous(labels = label_number(big.mark = ",")) +
  theme_classic() +
  theme(legend.position = "none") +
  scale_colour_jco() +
  labs(x = "", y = "",
       title = "Resident live-births and total live-births in Singapore",
       caption = "Source: Ministry of Trade and Industry - Department of Statistics (data.gov.sg)\nGraphic: @weiyuet")
```

## Total Fertility Rate by Ethnic Groups

The Total Fertility Rate refers to the average number of live-births each female would have during her reproductive years if she were to experience the age-specific fertility rates prevailing during the period. It is derived by aggregating the age-specific fertility rates of females in each of the reproductive ages for a specific year.

```{r Fertility rate ethnic group}
#Load data
total_fertility_rate_by_ethnic_group <- read_csv("data/births-and-fertility-annual/total-fertility-rate-by-ethnic-group.csv")

#Plot fertility rate by ethnic groups
total_fertility_rate_by_ethnic_group %>% 
  ggplot(aes(x = year, y = value, colour = level_2)) +
  geom_line() +
  geom_point(aes(shape = level_2)) +
  geom_hline(yintercept = 2.1, linetype = 2, size = 0.5) +
  theme_classic() +
  theme(legend.title = element_blank(),
        legend.position = c(0.85, 0.55)) +
  scale_x_continuous(breaks = seq(1960, 2020, 5)) +
  scale_y_continuous(breaks = seq(0, 8, 0.5), labels = label_number(decimal.mark = '.', accuracy = 0.1)) +
  scale_colour_jco() +
  labs(x = "", y ="",
       title = "Total Fertility Rate by Ethnic Groups",
       subtitle = "Dashed line at 2.1 represents the population replacement rate",
       caption = "Source: Ministry of Trade and Industry - Department of Statistics (data.gov.sg)\nGraphic: @weiyuet")
```

# Health

## Life Expectancy

In contrast to falling birth rates and fertility rates, the life expectancy has been increasing steadily.

```{r Life expectancy}
#Load data
life_expectancy <- read_csv('data/life-expectancy-by-sex-annual/life-expectancy-at-birth-and-age-65-years.csv')

#Plot data
#Line plot of life expectancy
life_expectancy %>% 
  ggplot(aes(x = year, y = value, colour = level_1)) +
  geom_line(size = 1) +
  facet_wrap(~level_1, scales = 'free_y') +
  scale_x_continuous(breaks = seq(1960, 2020, 10)) +
  scale_colour_jco() +
  theme_classic() +
  theme(legend.title = element_blank(),
        legend.position = 'none') +
  labs(x = '', y = '',
       title = 'Life Expectancy of Residents in Singapore',
       caption = 'Source: Ministry of Trade and Industry - Department of Statistics (data.gov.sg)\nGraphic: @weiyuet')

#Change in life expectancy
life_expectancy %>% 
  filter(year == 1960 | year == 2018) %>%
  pivot_wider(names_from = year, values_from = value) %>% 
  mutate(gap = `2018` - `1960`) %>%
  arrange(desc(gap)) %>%
  ggplot(aes(x = `1960`, xend = `2018`, y = reorder(level_1, gap)),
         group = level_1) +
  geom_dumbbell(colour = "#dddddd",
                size = 5,
                colour_x = "#FAAB18",
                colour_xend = "#1380A1") +
  scale_x_continuous(limits = c(0, 85),
                     breaks = seq(0, 85, 5)) +
  scale_y_discrete(labels = c("From Age 65", "At Birth")) +
  theme_classic() +
  labs(x = "", y = "",
       title = "We're living longer",
       subtitle = "Change in life expectancy between 1960 - 2018",
       caption = 'Source: Ministry of Trade and Industry - Department of Statistics (data.gov.sg)\nGraphic: @weiyuet')
```

# Number of Students in Primary and Secondary Schools

Together with the falling birth rate, the number of students in primary and secondary schools have also been declining.

This has lead to the Ministry of Education [merging and closing schools.](https://www.moe.gov.sg/news/press-releases/20210407-school-mergers)

Although, the student-teacher ratio has been decreasing (which is considered a positive metric).

## Number of Students in Primary Schools
```{r Number of students in primary schools}
#Load data
students_and_teachers_primary_schools <- read_csv("data/students-and-teachers-in-schools/students-and-teachers-primary-schools.csv")

#Plot number of students in primary schools
students_and_teachers_primary_schools %>% 
  ggplot(aes(x = year, y = students_pri,
             colour = school_type)) +
  geom_line(size = 1) +
  facet_wrap(~sex) +
  theme_classic() +
  theme(legend.position = "bottom",
        legend.title = element_blank()) +
  guides(colour = guide_legend(nrow = 1)) +
  scale_colour_jco() +
  scale_x_continuous(breaks = seq(1980, 2020, 5)) +
  scale_y_continuous(labels = label_number(big.mark = ","), 
                     limits = c(10000, 250000)) +
  labs(x = "", y = "",
       title = "Number of Students in Primary Schools",
       colour = "School Type",
       caption = "Source: Ministry of Education (data.gov.sg)\nGraphic: @weiyuet")
```

## Student-Teacher Ratio in Primary Schools
```{r Student-teacher ratio in primary schools}
#Wrangle data
#Calculate student-teacher ratio
students_and_teachers_primary_schools <- students_and_teachers_primary_schools %>% 
  mutate(student_teacher_ratio = students_pri/teachers_pri)

students_and_teachers_primary_schools %>% 
  filter(sex == "MF") %>%
  ggplot(aes( x = year, y = student_teacher_ratio, colour = school_type)) +
  geom_smooth() +
  geom_jitter() +
  facet_wrap(~school_type) +
  theme_classic() +
  theme(legend.position = "none") +
  scale_colour_jco() +
  labs(x = "", y = "",
       title = "Student-Teacher Ratio in Primary Schools",
       caption = "Source: Ministry of Education (data.gov.sg)\nGraphic: @weiyuet")
```

## Number of Students in Secondary Schools
```{r Number of students in secondary schools}
#Load data
students_and_teachers_secondary_schools <- read_csv("data/students-and-teachers-in-schools/students-and-teachers-secondary-schools.csv")

#Plot number of secondary school students
students_and_teachers_secondary_schools %>% 
  ggplot(aes(x = year, y = student_sec,
             colour = school_type)) +
  geom_line(size = 1) +
  facet_wrap(~sex) +
  theme_classic() +
  theme(legend.position = "bottom",
        legend.title = element_blank()) +
  guides(colour = guide_legend(nrow = 1)) +
  scale_colour_jco() +
  scale_x_continuous(breaks = seq(1980, 2020, 5)) +
  scale_y_continuous(labels = label_number(big.mark = ",")) +
  labs(x = "", y = "",
       title = "Number of Students in Secondary Schools",
       colour = "School Type",
       caption = "Source: Ministry of Education (data.gov.sg)\nGraphic: @weiyuet")
```

## Student-Teacher Ratio in Seondary Schools
```{r Student-teacher ratio in secondary schools}
#Wrangle data
#Calculate student-teacher ratio
students_and_teachers_secondary_schools <- students_and_teachers_secondary_schools %>% 
  mutate(student_teacher_ratio = student_sec/teacher_sec)

students_and_teachers_secondary_schools %>% 
  filter(sex == "MF") %>%
  ggplot(aes( x = year, y = student_teacher_ratio, colour = school_type)) +
  geom_smooth() +
  geom_jitter() +
  facet_wrap(~school_type, scales = "free") +
  theme_classic() +
  theme(legend.position = "none") +
  scale_colour_jco() +
  labs(x = "", y = "",
       title = "Student-Teacher Ratio in Secondary Schools",
       caption = "Source: Ministry of Education (data.gov.sg)\nGraphic: @weiyuet")
```

# Infrastructure

## Housing

  - Being an island state, land is limited, and thus housing is a perennial issue.

  - The majority of people live in public housing, and the term evokes a different image compared to other countries.

### Flats Constructed By Housing And Development Board, Annual

```{r Flats constructed by hdb}
#Load data
flats_constructed <- read_csv("data/flats-constructed/flats-constructed-by-housing-and-development-board-annual.csv")

#Plot number of flats constructed
p <- flats_constructed %>%
  ggplot(aes(x = year, y = flats_constructed)) +
  geom_line() +
  scale_x_continuous(
    limits = c(1975, 2020),
    breaks = seq(1975, 2020, 5)
  ) +
  scale_y_continuous(
    limits = c(2000, 75000),
    breaks = seq(5000, 75000, 10000),
    labels = label_number(big.mark = ",")
  ) +
  theme_classic() +
  labs(
    x = "", y = "",
    title = "Flats Constructed By Housing And Development Board, Annual",
    caption = "Source: Housing and Development Board (data.gov.sg)\nGraphic: @weiyuet"
  )

#Annotate
p + (annotate("text", x = 1984, y = 70000, label = "67,017", size = 3)) + 
       (annotate("text", x = 2006, y = 8000, label = "2,733", size = 3))
```
